#:set red (204/255, 139/255, 134/255, 1)
#:set green (102/255, 143/255, 128/255, 1)
#:set blue (42/255, 98/255, 143/255, 1)
#:set yellow (255/255, 213/255, 46/255, 1)
#:set dark_yellow (200/255, 150/255, 120/255, 1) #(210/255, 168/255, 0/255, 1)
#:set grey (249/255, 249/255, 249/255, 1)

#:set grid_bg_color grey #(224/255, 201/255, 171/255, 1) 
#:set grid_border_color (180/255, 180/255, 180/255, 1) #(193/255, 163/255, 123/255, 1)
#:set grid_border_color_light (200/255, 200/255, 200/255, 1) #(193/255, 163/255, 123/255, 1)

#:set button_bg_color (229/255, 229/255, 229/255, 1)
#:set button_border_color yellow #(193/255, 163/255, 123/255, 1)

#:set label_bg_color (229/255, 229/255, 229/255, 1) #(224/255, 201/255, 171/255, 1)
#:set label_text_color (20/255, 8/255, 14/255, 1)

#:set screen_bg_color grey


<Board>:
	id: board_widget
	size_hint: (9/10, None)
	height: self.width
	pos_hint: {"center_x": 0.5, "top": 0.85}

	canvas.after:
		Color:
			rgba: grid_border_color
		Line:
			width: 4
			rectangle: self.x , self.y, self.width, self.height

		Line:
			width: 4
			points: self.x + self.width/(app.board_size**0.5), self.y, self.x+self.width/(app.board_size**0.5), self.y+self.height
		Line:
			width: 4
			points: self.x + 2 * self.width/(app.board_size**0.5), self.y, self.x + 2 * self.width/(app.board_size**0.5), self.y+self.height
		Line:
			width: 4
			points: self.x + 3 * self.width/(app.board_size**0.5), self.y, self.x + 3 * self.width/(app.board_size**0.5), self.y+self.height

		Line:
			width: 4
			points: self.x, self.y + self.height/(app.board_size**0.5), self.x + self.width, self.y + self.height/(app.board_size**0.5)
		Line:
			width: 4
			points: self.x, self.y + 2 * self.height/(app.board_size**0.5), self.x + self.width, self.y + 2 * self.height/(app.board_size**0.5)
		Line:
			width: 4
			points: self.x, self.y + 3 * self.height/(app.board_size**0.5), self.x + self.width, self.y + 3 * self.height/(app.board_size**0.5)


<ButtonUI>:
	border_color: []
	font_size: 306/app.board_size
	color: 0,0,0,1
	background_normal: ''
	background_color: button_bg_color
#	size_hint: (1/10, 9/160)
	canvas.before:
		Color:
			rgba: (120/255, 120/255, 120/255, 1)
		Line:
			width: 5
			rectangle: self.x , self.y, self.width, self.height

<Label>:
	halign: "center"
	valign: "middle"
	font_size: 306/app.board_size
	color: label_text_color
	canvas.before:
		Color: 
			rgba: label_bg_color
		Rectangle:
			pos: (self.x, self.y)
			size: (self.width, self.height)
<BoardLabel>:
	halign: "center"
	valign: "middle"
	font_size: self.height/2 #306/app.board_size
	color: (50/255, 50/255, 50/255, 1) #145/255, 120/255, 88/255, 1
	canvas.before:
		Color: 
			rgba: grid_bg_color
		Rectangle:
			pos: (self.x, self.y)
			size: (self.width, self.height)
		Color:
			rgba: grid_border_color_light
		Line:
			width: 2
			rectangle: self.x , self.y, self.width, self.height
<NumInput>:
	halign: "center"
	multiline: False
	input_type: "number"
	input_filter: "int"
	font_size: self.height/2 #306/app.board_size
	padding: [0, self.height / 2.0 - (self.line_height / 2.0) * len(self._lines)]
	font_color: 1, 0, 0, 1
	background_normal: ''
	background_color: grid_bg_color
	canvas.after:
		Color:
			rgba: grid_border_color_light
		Line:
			width: 2
			rectangle: self.x , self.y, self.width, self.height

<Screen>:
	canvas.before:
		Color:
			rgba: screen_bg_color
		Rectangle:
			pos: 0,0
			size: self.width, self.height

<ScreenManager>:
	id: screen_manager
	Screen:
		name: "Main"
		id: main_screen
		Label:
			text: "Sudoku Solver"
			font_size: 72
			size_hint: (1, 0.15)
			pos_hint: {"center_x": 0.5, "center_y":0.8}

			canvas.before:
				Color:
					rgba: yellow
				Rectangle:
					size: self.size
					pos: self.pos
				Color:
					rgba: dark_yellow #[yellow[i] - (0.2, 0.2, 0.2, 0)[i] for i in range(4)]
				Line:
					width: 5
					points: self.x, self.y, self.right, self.y
				Line:
					width: 5
					points: self.x, self.top, self.right, self.top
		
		ButtonUI:
			font_size: 36
			text: "Play"
			pos_hint: {"center_x": 0.5, "top": 0.5}
			size_hint: (0.65, 0.1)
			on_release:
				app.load_game()
				app.transition("Loading", "left")

		ButtonUI:
			font_size: 36
			text: "Generate Solution"
			pos_hint: {"center_x": 0.5, "top": 0.35}
			size_hint: (0.65, 0.1)
			on_release:
				app.load_game(game_type="Solve")
				app.transition("Loading", "left")

		Label:
			text: "Board Size"
			size_hint: (1, 0.05)
			pos_hint: {"center_x": 0.5, "top":0.225}
			canvas.before:
				Color: 
					rgba: yellow #255/255, 255/255, 255/255, 1
				Rectangle:
					pos: (self.x, self.y)
					size: (self.width, self.height)
				Color:
					rgba: dark_yellow
				Line:
					width: 3
					points: self.x, self.y, self.right, self.y
				Line:
					width: 3
					points: self.x, self.top, self.right, self.top
		BoxLayout:
			id: size_layout
			orientation: "horizontal"
			spacing: 50
			size_hint: (0.85, 0.075)
			pos_hint: {"x":0.075, "top":0.15}
			ButtonUI:
				text: "4x4"
				#border_color: red
				on_release: app.select_board_size(4, "red")
		
			ButtonUI:
				text: "9x9"
				#border_color: green
				on_release: app.select_board_size(9, "green")
				disabled: True
					
			ButtonUI:
				text: "16x16"
				#border_color: yellow
				on_release: app.select_board_size(16, "yellow")
#				canvas.before:
#					Color:
#						rgba: button_border_color
#					Line:
#						width: 5
#						rectangle: self.x , self.y, self.width, self.height
	Screen:
		id: board_screen
		name: "Board"
		
		Label:
			id: solvedLabel
			text: "Not Solved"
			color: 1,0,0,1
#			font_size: 42
			size_hint: (None, 0.05)
			width: self.texture_size[0]
			pos_hint: {"x": 0.05, "top":0.215}
			canvas.before:
				Color: 
					rgba: screen_bg_color
				Rectangle:
					pos: (self.x, self.y)
					size: (self.width, self.height)
		
		Label:
			id: tilesLabel
			text: "Tiles remaining:"
#			color: 1,0,0,1
#			font_size: 42
			size_hint: (None, 0.05)
			width: self.texture_size[0]
			pos_hint: {"right": 0.95, "top":0.215}
			canvas.before:
				Color: 
					rgba: screen_bg_color
				Rectangle:
					pos: (self.x, self.y)
					size: (self.width, self.height)
		
		Label:
			id: timer_label
			halign: "left"
			text_size: self.size
			text: " Time remaining"
#			font_size: 42
			size_hint: (0.7, 0.05)
			pos_hint: {"x": 0.025, "top":0.975}
			canvas.before:
				Color: 
					rgba: yellow #255/255, 201/255, 171/255, 1
				RoundedRectangle:
					pos: (self.x-5, self.y-5)
					size: (self.width+10, self.height+10)
					radius : [10,10,10,10]
				Color:
					rgba: dark_yellow
				Line:
					width: 3
					rectangle: self.x-5, self.y-5, self.width+10, self.height+10

		Label:
			text: "Board Status"
			size_hint: (1, 0.05)
			pos_hint: {"center_x": 0.5, "top":0.275}
			canvas.before:
				Color: 
					rgba: yellow #255/255, 255/255, 255/255, 1
				Rectangle:
					pos: (self.x, self.y)
					size: (self.width, self.height)
				Color:
					rgba: dark_yellow #[yellow[i] - (0.2, 0.2, 0.2, 0)[i] for i in range(4)]
				Line:
					width: 3
					points: self.x, self.y, self.right, self.y
				Line:
					width: 3
					points: self.x, self.top, self.right, self.top
		
		ButtonUI:
			id: solve_button
#			font_size: 36
			text: "Solve"
			pos_hint: {"center_x": 0.5, "top": 0.1}
			size_hint: (0.9, 0.05)
			disabled: True		
			on_release: app.solve_board()
		
#		ButtonUI:
#			font_size: 36
#			text: "Generate"
#			pos_hint: {"x": 0.6, "y": 0.175}
#			size_hint: (0.25, 0.1)
#			on_release:
#				app.load_game(type="Solve")
#				app.transition("Loading", "left")

		ButtonUI:
			font_size: 28
			text: "Home"
			pos_hint: {"right": 0.975, "top": 0.975}
			size_hint: (0.2, 0.05)
			on_press: app.transition("Main", "right")
	Screen:
		name: "Loading"
		Label:
			font_size: 64
			text: "Loading..."